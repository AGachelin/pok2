Code based on https://en.ittrip.xyz/c-language/c-kvm-hypervisor-guide
And https://lwn.net/Articles/658511/